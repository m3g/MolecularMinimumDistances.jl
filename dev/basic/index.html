<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Basic use · MolecularMinimumDistances.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.039/juliamono-regular.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.svg" alt="MolecularMinimumDistances.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">MolecularMinimumDistances.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li class="is-active"><a class="tocitem" href>Basic use</a><ul class="internal"><li><a class="tocitem" href="#Installation-and-loading"><span>Installation and loading</span></a></li><li><a class="tocitem" href="#Example-input-files"><span>Example input files</span></a></li><li><a class="tocitem" href="#Two-sets-of-molecules"><span>Two sets of molecules</span></a></li></ul></li><li><a class="tocitem" href="../advanced/">Advanced use</a></li><li><a class="tocitem" href="../reference/">Reference</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Basic use</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Basic use</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/m3g/MolecularMinimumDistances.jl/blob/master/docs/src/basic.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="User-guide"><a class="docs-heading-anchor" href="#User-guide">User guide</a><a id="User-guide-1"></a><a class="docs-heading-anchor-permalink" href="#User-guide" title="Permalink"></a></h1><p>Here the usage of the functions that allocate the list of distances will be described. Different running modes are available depending on the expected output.</p><h2 id="Installation-and-loading"><a class="docs-heading-anchor" href="#Installation-and-loading">Installation and loading</a><a id="Installation-and-loading-1"></a><a class="docs-heading-anchor-permalink" href="#Installation-and-loading" title="Permalink"></a></h2><p>To install <code>MolecularMinimumDistances</code>, first download and install Julia (1.6 or greater) from <a href="https://julialang.org/downloads">https://julialang.org/downloads/</a>. Install and run it. Then, use:</p><pre><code class="language-julia-repl hljs">julia&gt; import Pkg; Pkg.add(&quot;MolecularMinimumDistances&quot;)

julia&gt; using MolecularMinimumDistances</code></pre><h2 id="Example-input-files"><a class="docs-heading-anchor" href="#Example-input-files">Example input files</a><a id="Example-input-files-1"></a><a class="docs-heading-anchor-permalink" href="#Example-input-files" title="Permalink"></a></h2><p>The examples here use a molecular system, but the package actually only considers the coordinates of the atoms and the number of atoms of each molecule. Thus, more general distance problems can be tackled.</p><p>The input of the following tests can be obtained with:</p><pre><code class="language-julia-repl hljs">julia&gt; using PDBTools

julia&gt; system = MolecularMinimumDistances.download_example() 
   Array{Atoms,1} with 62026 atoms with fields:
   index name resname chain   resnum  residue        x        y        z  beta occup model segname index_pdb
       1    N     ALA     A        1        1   -9.229  -14.861   -5.481  0.00  1.00     1    PROT         1
       2  HT1     ALA     A        1        1  -10.048  -15.427   -5.569  0.00  0.00     1    PROT         2
       3  HT2     ALA     A        1        1   -9.488  -13.913   -5.295  0.00  0.00     1    PROT         3
                                                       ⋮ 
   62024  OH2    TIP3     C     9339    19638   13.485   -4.534  -34.438  0.00  1.00     1    WAT2     62024
   62025   H1    TIP3     C     9339    19638   13.218   -3.647  -34.453  0.00  1.00     1    WAT2     62025
   62026   H2    TIP3     C     9339    19638   12.618   -4.977  -34.303  0.00  1.00     1    WAT2     62026
</code></pre><p>The system consists of a protein (with 1463 atoms), solvated by 181 TMAO molecules (with 14 atoms each), 19338 water molecules, and some ions. </p><p>This is a snapshot of a simulation which was performed with cubic periodic boundary conditions, with a box side of <code>84.48</code> Angstrom. We will use periodic boundary conditions in the examples. </p><p>The coordinates of each of the types of molecules can be extracted from the <code>system</code> array of atoms with (using <code>PDBTools</code>):</p><pre><code class="language-julia-repl hljs">julia&gt; xprot = coor(system,&quot;protein&quot;)
1463-element Vector{StaticArrays.SVector{3, Float64}}:
 [-9.229, -14.861, -5.481]
 [-10.048, -15.427, -5.569]
 [-9.488, -13.913, -5.295]
 ⋮
 [6.408, -12.034, -8.343]
 [6.017, -10.967, -9.713]

julia&gt; tmao = coor(system,&quot;resname TMAO&quot;)
2534-element Vector{StaticArrays.SVector{3, Float64}}:
 [-23.532, -9.347, 19.545]
 [-23.567, -7.907, 19.381]
 [-22.498, -9.702, 20.497]
 ⋮
 [13.564, -16.517, 12.419]
 [12.4, -17.811, 12.052]

julia&gt; water = coor(system,&quot;water&quot;)
58014-element Vector{StaticArrays.SVector{3, Float64}}:
 [-28.223, 19.92, -27.748]
 [-27.453, 20.358, -27.476]
 [-27.834, 19.111, -28.148]
 ⋮
 [13.218, -3.647, -34.453]
 [12.618, -4.977, -34.303]</code></pre><p>Using these vectors of coordinates, we will illustrate the use of the current package.</p><h2 id="Two-sets-of-molecules"><a class="docs-heading-anchor" href="#Two-sets-of-molecules">Two sets of molecules</a><a id="Two-sets-of-molecules-1"></a><a class="docs-heading-anchor-permalink" href="#Two-sets-of-molecules" title="Permalink"></a></h2><p>The simplest usage consists of finding for each molecule of one set the atoms of the other set which are closer to them. For example, if we want the atoms of the proteins which are closer to each TMAO molecule (14 atoms), within a cutoff of <code>12.0</code> Angstroms, we do:</p><h3 id="Without-periodic-boundary-conditions"><a class="docs-heading-anchor" href="#Without-periodic-boundary-conditions">Without periodic boundary conditions</a><a id="Without-periodic-boundary-conditions-1"></a><a class="docs-heading-anchor-permalink" href="#Without-periodic-boundary-conditions" title="Permalink"></a></h3><pre><code class="language-julia-repl hljs">julia&gt; list = minimum_distances(tmao, protein, 14, 12.0)
181-element Vector{MinimumDistance{Float64}}:
 MinimumDistance{Float64}(false, 0, 0, Inf)
 MinimumDistance{Float64}(false, 0, 0, Inf)
 MinimumDistance{Float64}(false, 0, 0, Inf)
 ⋮
 MinimumDistance{Float64}(false, 0, 0, Inf)
 MinimumDistance{Float64}(true, 2526, 97, 9.652277658666891)</code></pre><p>The list obtained contains, for each molecule of TMAO, a structure of type <code>MinimumDistance</code>, containing:</p><ol><li>A boolean marker, which is <code>true</code> if some protein atom was found within the desired cutoff, <code>false</code> otherwise (field <code>x.within_cutoff</code>).</li><li>The index of the TMAO atom (field <code>x.i</code>).</li><li>The index of the protein atom (field <code>x.j</code>).</li><li>The distance between these atoms (field <code>x.d</code>).</li></ol><p>For instance, the number of molecules of TMAO having a protein atom within the cutoff are, here:</p><pre><code class="language-julia-repl hljs">julia&gt; count(x -&gt; x.within_cutoff, list)
33</code></pre><p>For each molecule of water, he have, similarly:</p><pre><code class="language-julia-repl hljs">julia&gt; list = minimum_distances(water,protein,3,12.)
19338-element Vector{MinimumDistance{Float64}}:
 MinimumDistance{Float64}(false, 0, 0, Inf)
 MinimumDistance{Float64}(false, 0, 0, Inf)
 MinimumDistance{Float64}(false, 0, 0, Inf)
 ⋮
 MinimumDistance{Float64}(true, 58011, 383, 10.24673074692606)
 MinimumDistance{Float64}(false, 0, 0, Inf)

julia&gt; count(x -&gt; x.within_cutoff, list)
2251</code></pre><h3 id="With-periodic-boundary-conditions"><a class="docs-heading-anchor" href="#With-periodic-boundary-conditions">With periodic boundary conditions</a><a id="With-periodic-boundary-conditions-1"></a><a class="docs-heading-anchor-permalink" href="#With-periodic-boundary-conditions" title="Permalink"></a></h3><p>The example simulation was performed with cubic periodic boundary conditions. Let us provide the box information now. We will exemplify with the calculation of the nearest atoms of the water molecules. The interface here is that define by the <code>Box</code> constructor of <code>CellListMap.jl</code>, described in detail <a href="https://m3g.github.io/CellListMap.jl/stable/pbc/">here</a>. General periodic boundary conditions are supported. </p><p>The box here is cubic, and we need to provide to the <code>Box</code> constructor the sides and the cutoff:</p><pre><code class="language-julia-repl hljs">julia&gt; box = Box([84.48, 84.48, 84.48], 12.)
Box{CellListMap.OrthorhombicCell, 3, Float64, Float64, 9}
  unit cell matrix = [ 84.48, 0.0, 0.0; 0.0, 84.48, 0.0; 0.0, 0.0, 84.48 ]
  cutoff = 12.0
  number of computing cells on each dimension = [9, 9, 9]
  computing cell sizes = [12.06857142857143, 12.06857142857143, 12.06857142857143] (lcell: 1)
  Total number of cells = 729</code></pre><p>And the <code>minimum_distance</code> function is called with the <code>box</code> instead of the <code>cutoff</code>:</p><pre><code class="language-julia-repl hljs">julia&gt; list = minimum_distances(water,protein,3,box)
19338-element Vector{MinimumDistance{Float64}}:
 MinimumDistance{Float64}(false, 0, 0, Inf)
 MinimumDistance{Float64}(false, 0, 0, Inf)
 MinimumDistance{Float64}(false, 0, 0, Inf)
 ⋮
 MinimumDistance{Float64}(true, 58011, 383, 10.24673074692606)
 MinimumDistance{Float64}(false, 0, 0, Inf)</code></pre><h3 id="Advanced,-non-allocating-call"><a class="docs-heading-anchor" href="#Advanced,-non-allocating-call">Advanced, non-allocating call</a><a id="Advanced,-non-allocating-call-1"></a><a class="docs-heading-anchor-permalink" href="#Advanced,-non-allocating-call" title="Permalink"></a></h3><p>If this function will be called from within a loop where the coordinates of the molecules involved change, a faster and non-allocating call can be used, by exposing the interface of <code>CellListMap</code>. For example:</p><pre><code class="language-julia-repl hljs">julia&gt; function iterate_lists(nsteps, list, water, protein, box, cl, aux)
           inds(i) = mol_index(i,3)
           for i in 1:nsteps
               # water and protein coordinates, and box, could change here
               cl = UpdateCellList!(water, protein, box, cl, aux)
               minimum_distances!(inds, list, box, cl)
               # list was updated
           end
        end

</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../">« Home</a><a class="docs-footer-nextpage" href="../advanced/">Advanced use »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.15 on <span class="colophon-date" title="Friday 25 March 2022 14:24">Friday 25 March 2022</span>. Using Julia version 1.7.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
